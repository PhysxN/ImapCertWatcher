<Window x:Class="ImapCertWatcher.ServerSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Настройки сервера"
        Width="500"
        Height="550"
        WindowStartupLocation="CenterOwner">

    <ScrollViewer Padding="10">
        <StackPanel>

            <!-- ================= MAIL ================= -->

            <TextBlock Text="Почта" FontWeight="Bold"/>

            <TextBlock Text="IMAP сервер"/>
            <TextBox Text="{Binding MailHost}"
                     ToolTip="Адрес IMAP сервера. Например: imap.yandex.ru, imap.gmail.com"/>

            <TextBlock Text="Порт"/>
            <TextBox Text="{Binding MailPort}"
                     ToolTip="Порт IMAP сервера. Обычно: 993 (SSL), 143 (без SSL)"/>

            <CheckBox Content="SSL"
                      IsChecked="{Binding MailUseSsl}"
                      ToolTip="Использовать защищенное SSL соединение (рекомендуется)"/>

            <TextBlock Text="Логин"/>
            <TextBox Text="{Binding MailLogin}"
                     ToolTip="Логин почтового ящика (обычно email полностью)"/>

            <TextBlock Text="Пароль"/>
            <PasswordBox x:Name="MailPasswordBox"
                         ToolTip="Пароль от почтового ящика"/>

            <Button Content="Обновить список папок"
                    Margin="0,8,0,4"
                    Click="RefreshFolders_Click"
                    ToolTip="Получить список папок с IMAP сервера"/>
            <Button Content="Проверить подключение к почте"
        Margin="0,4,0,4"
        Click="TestMail_Click"
        ToolTip="Проверить подключение к IMAP серверу с текущими параметрами"/>

            <TextBlock Text="Папка новых сертификатов"/>
            <ComboBox ItemsSource="{Binding ImapFolders, RelativeSource={RelativeSource AncestorType=Window}}"
                      SelectedItem="{Binding ImapNewCertificatesFolder, Mode=TwoWay}"
                      Text="{Binding ImapNewCertificatesFolder, Mode=TwoWay}"
                      IsEditable="True"
                      ToolTip="IMAP папка, в которую приходят письма с новыми сертификатами"/>

            <TextBlock Text="Папка аннулирований"/>
            <ComboBox ItemsSource="{Binding ImapFolders, RelativeSource={RelativeSource AncestorType=Window}}"
                      SelectedItem="{Binding ImapRevocationsFolder, Mode=TwoWay}"
                      Text="{Binding ImapRevocationsFolder, Mode=TwoWay}"
                      IsEditable="True"
                      ToolTip="IMAP папка с письмами об аннулировании сертификатов"/>

            <Separator Margin="0,10"/>

            <!-- ================= DATABASE ================= -->

            <TextBlock Text="База данных Firebird" FontWeight="Bold"/>

            <TextBlock Text="Сервер Firebird"/>
            <TextBox Text="{Binding FbServer}"
         ToolTip="IP адрес или имя сервера Firebird. Обычно: 127.0.0.1"/>

            <TextBlock Text="Путь к базе данных"/>
            <TextBox Text="{Binding FirebirdDbPath}"
         ToolTip="Полный путь к файлу базы Firebird (.fdb)"/>

            <TextBlock Text="Логин Firebird"/>
            <TextBox Text="{Binding FbUser}"
         ToolTip="Имя пользователя Firebird. Обычно: SYSDBA"/>

            <TextBlock Text="Пароль Firebird"/>
            <PasswordBox x:Name="DbPasswordBox"
             ToolTip="Пароль пользователя Firebird"/>

            <TextBlock Text="Диалект Firebird"/>
            <TextBox Text="{Binding FbDialect}"
         ToolTip="Версия SQL диалекта. Рекомендуется: 3"/>
            <Button Content="Проверить подключение Firebird"
        Margin="0,6,0,0"
        Click="TestDb_Click"
        ToolTip="Проверить подключение к базе Firebird"/>

            <!-- ================= SERVER ================= -->

            <TextBlock Text="Интервал проверки" FontWeight="Bold"/>

            <TextBox Text="{Binding CheckIntervalMinutes}"
                     ToolTip="Интервал автоматической проверки почты в минутах"/>

            <TextBlock Text="Дней до окончания сертификата"/>
            <TextBox Text="{Binding NotifyDaysThreshold}"
                     ToolTip="За сколько дней до окончания сертификата отправлять уведомления"/>

            <CheckBox Content="Проверять и уведомлять только в рабочее время"
                      IsChecked="{Binding NotifyOnlyInWorkHours}"
                      Margin="0,6,0,0"
                      ToolTip="Если включено — проверки и уведомления выполняются только в рабочее время"/>

            <Separator Margin="0,10"/>

            <!-- ================= BIMOID ================= -->

            <TextBlock Text="Bimoid" FontWeight="Bold"/>

            <TextBlock Text="Аккаунты Краснофлотская"/>
            <TextBox Text="{Binding BimoidAccountsKrasnoflotskaya}"
                     AcceptsReturn="True"
                     Height="60"
                     ToolTip="Список аккаунтов Bimoid для Краснофлотской. Один аккаунт на строку"/>

            <TextBlock Text="Аккаунты Пионерская" Margin="0,6,0,0"/>
            <TextBox Text="{Binding BimoidAccountsPionerskaya}"
                     AcceptsReturn="True"
                     Height="60"
                     ToolTip="Список аккаунтов Bimoid для Пионерской. Один аккаунт на строку"/>

            <Separator Margin="0,10"/>

            <!-- ================= SAVE ================= -->

            <Button Content="Сохранить"
                    Width="120"
                    HorizontalAlignment="Right"
                    Click="Save_Click"
                    ToolTip="Сохранить настройки сервера"/>
        </StackPanel>
    </ScrollViewer>
</Window>
