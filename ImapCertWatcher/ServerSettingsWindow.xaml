<Window x:Class="ImapCertWatcher.ServerSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Настройки сервера"
        Width="520"
        Height="550"
        WindowStartupLocation="CenterOwner">

    <ScrollViewer Padding="12">
        <StackPanel>

            <!-- ================= MAIL ================= -->

            <TextBlock Text="Почта"
                       FontWeight="Bold"
                       Margin="0,0,0,6"/>

            <Grid Margin="0,0,0,8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="170"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="IMAP сервер"/>
                <TextBox Grid.Row="0" Grid.Column="1"
                         Text="{Binding MailHost}"
                         ToolTip="Адрес IMAP сервера. Например: imap.yandex.ru"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Порт"/>
                <TextBox Grid.Row="1" Grid.Column="1"
                         Text="{Binding MailPort}"
                         ToolTip="Обычно: 993 (SSL), 143 (без SSL)"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="SSL"/>
                <CheckBox Grid.Row="2" Grid.Column="1"
                          IsChecked="{Binding MailUseSsl}"
                          ToolTip="Использовать защищенное соединение"/>

                <TextBlock Grid.Row="3" Grid.Column="0" Text="Логин"/>
                <TextBox Grid.Row="3" Grid.Column="1"
                         Text="{Binding MailLogin}"
                         ToolTip="Логин почтового ящика"/>

                <TextBlock Grid.Row="4" Grid.Column="0" Text="Пароль"/>
                <PasswordBox Grid.Row="4" Grid.Column="1"
                             x:Name="MailPasswordBox"
                             ToolTip="Пароль от почты"/>
            </Grid>

            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        Margin="0,4">

                <Button Content="Обновить папки"
                        Margin="0,0,6,0"
                        Click="RefreshFolders_Click"
                        ToolTip="Загрузить список папок с IMAP"/>

                <Button Content="Проверить почту"
                        Click="TestMail_Click"
                        ToolTip="Проверить подключение к почте"/>
            </StackPanel>

            <Grid Margin="0,6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="170"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Новые сертификаты"/>

                <ComboBox x:Name="cmbNewCertsFolder"
          Grid.Row="0" Grid.Column="1"
          ItemsSource="{Binding ImapFolders, RelativeSource={RelativeSource AncestorType=Window}}"
          SelectedItem="{Binding ImapNewCertificatesFolder, Mode=TwoWay}"
          Text="{Binding ImapNewCertificatesFolder, Mode=TwoWay}"
          IsEditable="True"
          ToolTip="Папка с новыми сертификатами"/>


                <TextBlock Grid.Row="1" Grid.Column="0" Text="Аннулирования"/>

                <ComboBox x:Name="cmbRevocationsFolder"
          Grid.Row="1" Grid.Column="1"
          ItemsSource="{Binding ImapFolders, RelativeSource={RelativeSource AncestorType=Window}}"
          SelectedItem="{Binding ImapRevocationsFolder, Mode=TwoWay}"
          Text="{Binding ImapRevocationsFolder, Mode=TwoWay}"
          IsEditable="True"
          ToolTip="Папка аннулирований"/>
            </Grid>

            <Separator Margin="0,12"/>

            <!-- ================= FIREBIRD ================= -->

            <TextBlock Text="Firebird"
                       FontWeight="Bold"
                       Margin="0,0,0,6"/>

            <Grid Margin="0,0,0,6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="170"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Сервер"/>
                <TextBox Grid.Row="0" Grid.Column="1"
                         Text="{Binding FbServer}"
                         ToolTip="IP или имя сервера Firebird"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Путь к БД"/>
                <TextBox Grid.Row="1" Grid.Column="1"
                         Text="{Binding FirebirdDbPath}"
                         ToolTip="Полный путь к .fdb"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Логин"/>
                <TextBox Grid.Row="2" Grid.Column="1"
                         Text="{Binding FbUser}"/>

                <TextBlock Grid.Row="3" Grid.Column="0" Text="Пароль"/>
                <PasswordBox Grid.Row="3" Grid.Column="1"
                             x:Name="DbPasswordBox"/>

                <TextBlock Grid.Row="4" Grid.Column="0" Text="Диалект"/>
                <TextBox Grid.Row="4" Grid.Column="1"
                         Text="{Binding FbDialect}"
                         ToolTip="Обычно 3"/>
            </Grid>

            <Button Content="Проверить Firebird"
                    HorizontalAlignment="Right"
                    Click="TestDb_Click"
                    ToolTip="Проверить подключение к базе"/>

            <Separator Margin="0,12"/>

            <!-- ================= SERVER ================= -->

            <TextBlock Text="Сервер"
                       FontWeight="Bold"
                       Margin="0,0,0,6"/>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="170"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Интервал (мин)"/>
                <TextBox Grid.Row="0" Grid.Column="1"
                         Text="{Binding CheckIntervalMinutes}"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Уведомлять за (дней)"/>
                <TextBox Grid.Row="1" Grid.Column="1"
                         Text="{Binding NotifyDaysThreshold}"/>
            </Grid>

            <CheckBox Content="Рабочее время"
                      IsChecked="{Binding NotifyOnlyInWorkHours}"
                      Margin="0,6,0,0"
                      ToolTip="Проверять только в рабочие часы"/>

            <Separator Margin="0,12"/>

            <!-- ================= BIMOID ================= -->

            <TextBlock Text="Bimoid"
                       FontWeight="Bold"
                       Margin="0,0,0,6"/>

            <TextBlock Text="Краснофлотская"/>
            <TextBox Text="{Binding BimoidAccountsKrasnoflotskaya}"
                     AcceptsReturn="True"
                     Height="60"/>

            <TextBlock Text="Пионерская" Margin="0,6,0,0"/>
            <TextBox Text="{Binding BimoidAccountsPionerskaya}"
                     AcceptsReturn="True"
                     Height="60"/>

            <Separator Margin="0,12"/>

            <StackPanel Orientation="Horizontal"
            HorizontalAlignment="Right"
            Margin="0,8,0,0">

                <Button Content="Тестовое сообщение"
            Width="160"
            Margin="0,0,8,0"
            Click="BtnTestBimoid_Click"/>

                <Button Content="Тест нового пользователя"
            Width="180"
            Click="BtnTestNewUserNotify_Click"/>

            </StackPanel>

            <!-- ================= SAVE ================= -->

            <Button Content="Сохранить"
                    Width="140"
                    HorizontalAlignment="Right"
                    Click="Save_Click"/>

        </StackPanel>
    </ScrollViewer>
</Window>
