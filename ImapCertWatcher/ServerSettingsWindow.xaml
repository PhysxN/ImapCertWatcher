<Window x:Class="ImapCertWatcher.ServerSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Настройки сервера"
        Width="520"
        Height="550"
        WindowStartupLocation="CenterOwner">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>

    <ScrollViewer Padding="12">
        <StackPanel>

            <!-- ================= MAIL ================= -->

            <TextBlock Text="Почта"
                       FontWeight="Bold"
                       Margin="0,0,0,6"/>

            <Grid Margin="0,0,0,8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="170"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="IMAP сервер"/>
                <TextBox Grid.Row="0" Grid.Column="1"
                         Text="{Binding MailHost, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="Адрес IMAP сервера. Например: imap.yandex.ru"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Порт"/>
                <TextBox Grid.Row="1" Grid.Column="1"
                         Text="{Binding MailPort, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="Обычно: 993 (SSL), 143 (без SSL)"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="SSL"/>
                <CheckBox Grid.Row="2" Grid.Column="1"
                          IsChecked="{Binding MailUseSsl, Mode=TwoWay}"
                          ToolTip="Использовать защищенное соединение"/>

                <TextBlock Grid.Row="3" Grid.Column="0" Text="Логин"/>
                <TextBox Grid.Row="3" Grid.Column="1"
                         Text="{Binding MailLogin, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="Логин почтового ящика"/>

                <TextBlock Grid.Row="4" Grid.Column="0" Text="Пароль"/>
                <PasswordBox Grid.Row="4" Grid.Column="1"
                             x:Name="MailPasswordBox"
                             ToolTip="Пароль от почты"/>
            </Grid>

            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        Margin="0,4">

                

                <Button Content="Проверить почту"
                        Click="TestMail_Click"
                        ToolTip="Проверить подключение к почте"/>
            </StackPanel>

            <Grid Margin="0,6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="170"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="6"/>
                    <!-- под ProgressBar -->
                </Grid.RowDefinitions>

                <!-- Новые сертификаты -->

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Новые сертификаты"/>

                <ComboBox
        Grid.Row="0"
        Grid.Column="1"
        x:Name="cmbNewCertsFolder"
        ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ImapFolders}"
        SelectedItem="{Binding ImapNewCertificatesFolder, Mode=TwoWay}"
        IsEditable="True"
        IsEnabled="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=IsFoldersLoaded}"
        Margin="0,4,0,8"/>

                <!-- Аннулирования -->

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Аннулирования"/>

                <ComboBox
        Grid.Row="1"
        Grid.Column="1"
        x:Name="cmbRevocationsFolder"
        ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ImapFolders}"
        SelectedItem="{Binding ImapRevocationsFolder, Mode=TwoWay}"
        IsEditable="True"
        IsEnabled="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=IsFoldersLoaded}"
        Margin="0,4,0,8"/>

                <!-- Progress -->

                <ProgressBar
        Grid.Row="2"
        Grid.ColumnSpan="2"
        Height="4"
        Margin="0,4,0,0"
        IsIndeterminate="True"
        Visibility="{Binding RelativeSource={RelativeSource AncestorType=Window},
        Path=IsFoldersLoading,
        Converter={StaticResource BooleanToVisibilityConverter}}"/>
            </Grid>

            <Separator Margin="0,12"/>

            <!-- ================= FIREBIRD ================= -->

            <TextBlock Text="Firebird"
                       FontWeight="Bold"
                       Margin="0,0,0,6"/>

            <Grid Margin="0,0,0,6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="170"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Сервер"/>
                <TextBox Grid.Row="0" Grid.Column="1"
                         Text="{Binding FbServer, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="IP или имя сервера Firebird"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Путь к БД"/>
                <TextBox Grid.Row="1" Grid.Column="1"
                         Text="{Binding FirebirdDbPath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="Полный путь к .fdb"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Логин"/>
                <TextBox Grid.Row="2" Grid.Column="1"
                         Text="{Binding FbUser, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Grid.Row="3" Grid.Column="0" Text="Пароль"/>
                <PasswordBox Grid.Row="3" Grid.Column="1"
                             x:Name="DbPasswordBox"/>

                <TextBlock Grid.Row="4" Grid.Column="0" Text="Диалект"/>
                <TextBox Grid.Row="4" Grid.Column="1"
                         Text="{Binding FbDialect, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="Обычно 3"/>
            </Grid>

            <Button Content="Проверить Firebird"
                    HorizontalAlignment="Right"
                    Click="TestDb_Click"
                    ToolTip="Проверить подключение к базе"/>

            <Separator Margin="0,12"/>

            <!-- ================= SERVER ================= -->

            <TextBlock Text="Сервер"
                       FontWeight="Bold"
                       Margin="0,0,0,6"/>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="170"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Интервал (мин)"/>
                <TextBox Grid.Row="0" Grid.Column="1"
                         Text="{Binding CheckIntervalMinutes, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Уведомлять за (дней)"/>
                <TextBox Grid.Row="1" Grid.Column="1"
                         Text="{Binding NotifyDaysThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            </Grid>

            <CheckBox Content="Рабочее время"
                      IsChecked="{Binding NotifyOnlyInWorkHours, Mode=TwoWay}"
                      Margin="0,6,0,0"
                      ToolTip="Проверять только в рабочие часы"/>

            <Separator Margin="0,12"/>

            <!-- ================= BIMOID ================= -->

            <TextBlock Text="Bimoid"
                       FontWeight="Bold"
                       Margin="0,0,0,6"/>

            <TextBlock Text="Краснофлотская"/>
            <TextBox Text="{Binding BimoidAccountsKrasnoflotskaya, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     AcceptsReturn="True"
                     Height="60"/>

            <TextBlock Text="Пионерская" Margin="0,6,0,0"/>
            <TextBox Text="{Binding BimoidAccountsPionerskaya, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     AcceptsReturn="True"
                     Height="60"/>

            <Separator Margin="0,12"/>

            <StackPanel Orientation="Horizontal"
            HorizontalAlignment="Right"
            Margin="0,8,0,0">

                <Button Content="Тестовое сообщение"
            Width="160"
            Margin="0,0,8,0"
            Click="BtnTestBimoid_Click"/>

                <Button Content="Тест нового пользователя"
            Width="180"
            Click="BtnTestNewUserNotify_Click"/>

            </StackPanel>

            <!-- ================= SAVE ================= -->

            <Button Content="Сохранить"
                    Width="140"
                    HorizontalAlignment="Right"
                    Click="Save_Click"/>

        </StackPanel>
    </ScrollViewer>
</Window>
