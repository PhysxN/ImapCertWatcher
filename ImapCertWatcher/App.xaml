<Application x:Class="ImapCertWatcher.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Startup="Application_Startup">

    <Application.Resources>

        <!-- Подключаем styles.xaml -->
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- ===== Светлая тема ===== -->
            <SolidColorBrush x:Key="LightWindowBackground" Color="#FFFFFFFF"/>
            <SolidColorBrush x:Key="LightControlBackground" Color="#FFF0F0F0"/>
            <SolidColorBrush x:Key="LightTextColor" Color="#FF000000"/>
            <SolidColorBrush x:Key="LightBorderColor" Color="#FFCCCCCC"/>
            <SolidColorBrush x:Key="LightAccentColor" Color="#FF0078D7"/>
            <SolidColorBrush x:Key="LightHoverColor" Color="#FFE1E1E1"/>

            <!-- ===== Тёмная тема ===== -->
            <SolidColorBrush x:Key="DarkWindowBackground" Color="#FF2D2D30"/>
            <SolidColorBrush x:Key="DarkControlBackground" Color="#FF1E1E1E"/>
            <SolidColorBrush x:Key="DarkTextColor" Color="#FFFFFFFF"/>
            <SolidColorBrush x:Key="DarkBorderColor" Color="#FF555555"/>
            <SolidColorBrush x:Key="DarkAccentColor" Color="#FF007ACC"/>
            <SolidColorBrush x:Key="DarkHoverColor" Color="#FF3E3E42"/>

            <!-- ===== Активные кисти ===== -->
            <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#FFFFFFFF"/>
            <SolidColorBrush x:Key="ControlBackgroundBrush" Color="#FFF0F0F0"/>
            <SolidColorBrush x:Key="TextColorBrush" Color="#FF000000"/>
            <SolidColorBrush x:Key="BorderColorBrush" Color="#FFCCCCCC"/>
            <SolidColorBrush x:Key="AccentColorBrush" Color="#FF0078D7"/>
            <SolidColorBrush x:Key="HoverColorBrush" Color="#FFE1E1E1"/>

            <!-- ComboBox в DataGrid (режим редактирования ячейки) -->
            <Style x:Key="DataGridComboBoxStyle"
       TargetType="ComboBox">

                <Setter Property="Foreground"
            Value="{DynamicResource TextColorBrush}" />

                <Setter Property="Background"
            Value="{DynamicResource ControlBackgroundBrush}" />

                <Setter Property="BorderBrush"
             Value="Transparent" />

                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="6,2"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>

                <Setter Property="IsEditable" Value="False"/>

                <Style.Triggers>

                    <!-- Когда ячейка редактируется -->
                    <Trigger Property="IsKeyboardFocusWithin" Value="True">
                        <Setter Property="Background"
                    Value="{DynamicResource WindowBackgroundBrush}" />
                        <Setter Property="BorderBrush"
                    Value="{DynamicResource AccentColorBrush}" />
                    </Trigger>

                    <!-- Когда строка выделена -->
                    <Trigger Property="IsSelectionBoxHighlighted" Value="True">
                        <Setter Property="Foreground" Value="White"/>
                    </Trigger>

                </Style.Triggers>
            </Style>



            <!-- Базовый текст -->
            <Style TargetType="TextBlock">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
            </Style>

            <Style TargetType="Label">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
            </Style>

            <Style TargetType="GroupBox">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
            </Style>

            <Style TargetType="TextBox">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
                <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}" />
                <Setter Property="BorderBrush" Value="{DynamicResource BorderColorBrush}" />
            </Style>

            <Style TargetType="PasswordBox">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
                <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}" />
                <Setter Property="BorderBrush" Value="{DynamicResource BorderColorBrush}" />
                <Setter Property="CaretBrush" Value="{DynamicResource TextColorBrush}" />
            </Style>

            <Style TargetType="ComboBox">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
                <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}" />
                <Setter Property="BorderBrush" Value="{DynamicResource BorderColorBrush}" />
            </Style>

            <Style TargetType="CheckBox">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
            </Style>

            <Style TargetType="RadioButton">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
            </Style>

            <!-- Элементы выпадающего списка ComboBox -->
            <Style TargetType="ComboBoxItem">
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}" />
                <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}" />
                <Setter Property="Padding" Value="6,4" />

                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ComboBoxItem">
                            <Border x:Name="Bd"
                        Background="{TemplateBinding Background}"
                        Padding="{TemplateBinding Padding}">
                                <ContentPresenter />
                            </Border>

                            <ControlTemplate.Triggers>
                                <!-- Наведение -->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Bd"
                                Property="Background"
                                Value="{DynamicResource HoverColorBrush}" />
                                </Trigger>

                                <!-- Выбранный элемент -->
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="Bd"
                                Property="Background"
                                Value="{DynamicResource AccentColorBrush}" />
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>

                                <!-- Отключенный -->
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="Gray"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Ячейки DataGrid -->
            <Style TargetType="DataGridCell">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderBrush" Value="{DynamicResource BorderColorBrush}"/>
                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}"/>

                <Style.Triggers>

                    <!-- Выделенная ячейка -->
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="{DynamicResource AccentColorBrush}"/>
                        <Setter Property="Foreground" Value="White"/>
                    </Trigger>

                    <!-- Режим редактирования -->
                    <Trigger Property="IsEditing" Value="True">
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}"/>
                    </Trigger>

                </Style.Triggers>
            </Style>

            <!-- Строки DataGrid -->
            <Style TargetType="DataGridRow">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Foreground" Value="{DynamicResource TextColorBrush}"/>

                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Foreground" Value="White"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            
            

        </ResourceDictionary>

    </Application.Resources>
</Application>
